!function(){function e(e,i){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,i){if(!e)return;if("string"==typeof e)return t(e,i);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return t(e,i)}(e))||i&&e&&"number"==typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,c=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){c=!0,s=e},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw s}}}}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{"3wOr":function(t,n,r){"use strict";r.r(n),r.d(n,"CheckersModule",(function(){return C}));var s,o,c,l,h,u=r("PCNd"),d=r("iInd"),v=r("mrSG"),k=function(){var e=function(){function e(t){i(this,e),this.state=t}return a(e,[{key:"updatePosition",value:function(e){this.state.position.point=e}},{key:"makeKing",value:function(){this.state.isKing=!0}}],[{key:"checkerBuilder",value:function(t,i,n){var a={color:e.colors[t.state.id],player:t,position:i,radius:n,isKing:!1,center:e.getCenter(i,n)};return new e(a)}},{key:"getCenter",value:function(e,t){return{x:e.point.x+t,y:e.point.y+t}}}]),e}();return e.colors=["dodgerblue","goldenrod"],e}(),y=r("BFKe"),f=((o=function(){function e(t){i(this,e),this.state=t}return a(e,[{key:"buildChecker",value:function(e){var t=this.state.position,i=t.cell,n=t.point;this.state.checker=k.checkerBuilder(e,{cell:i,point:n},Math.floor(.46*this.state.width))}},{key:"hasChecker",value:function(){return this.state.checker!==e.empty&&this.state.checker!==e.unplayableSpace}},{key:"addChecker",value:function(e){e.state.position.cell=this.state.position.cell,e.state.position.point=this.state.position.point,this.state.checker=e}},{key:"removeChecker",value:function(){this.state.checker=e.empty}},{key:"checkForValidChecker",value:function(e){return!!this.hasChecker()&&e.state.id===this.state.checker.state.player.state.id}}],[{key:"boxBuilder",value:function(t,i,n){return new e({id:"".concat(i.cell.row).concat(i.cell.column),color:t?e.colors.playable:e.colors.unPlayable,checker:t?e.empty:e.unplayableSpace,position:i,width:n,height:n,absoluteCenter:y.a.findAbsoluteCenterPointOfRectangle(i,n,n),relativeCenter:y.a.findRelativeCenterPointOfRectangle(n,n)})}}]),e}()).colors={playable:"palegreen",unPlayable:"darkgray"},o.empty="empty",o.unplayableSpace="unplayable space",o),p=((s=function(){function e(t){i(this,e),this.state=t}return a(e,[{key:"setupBoardState",value:function(e){this.state={rows:8,columns:8,boxes:new Map,topPadding:null,sidePadding:null,playerOneCheckersRemaining:12,playerTwoCheckersRemaining:12,availableMoves:null},this.buildBoard(e),this.state.availableMoves=[]}},{key:"buildBoard",value:function(t){var i=t[0],n=t[1];this.state.boxes=new Map;for(var a=0;a<this.state.rows;a++)for(var r=0;r<this.state.columns;r++){var s=y.a.isOdd(a+r),o={row:a,column:r},c=this.getBoxPosition(a,r),l=f.boxBuilder(s,{cell:o,point:c},e.boxSize);s&&(a<3?l.buildChecker(i):a>4&&l.buildChecker(n)),this.state.boxes.set("".concat(a).concat(r),l)}}},{key:"removeCheckerFromBoard",value:function(e){this.decreasePlayersCheckers(e.state.checker),e.removeChecker()}},{key:"decreasePlayersCheckers",value:function(e){0===e.state.player.state.id?this.state.playerOneCheckersRemaining--:this.state.playerTwoCheckersRemaining--}},{key:"getBox",value:function(e){return this.state.boxes.get("".concat(e.row).concat(e.column))}},{key:"getBoxPosition",value:function(t,i){return{x:i*e.boxSize+this.state.sidePadding,y:t*e.boxSize+e.boxSize}}},{key:"getBoxIndex",value:function(t,i){return{row:Math.floor((i-this.state.topPadding-40)/e.boxSize),column:Math.floor((t-this.state.sidePadding)/e.boxSize)}}},{key:"getBoxesArray",value:function(){for(var e=[],t=0;t<this.state.rows;t++)for(var i=0;i<this.state.columns;i++)e.push(this.state.boxes.get("".concat(t).concat(i)));return e}},{key:"resetAvailableMoves",value:function(){this.state.availableMoves=[]}},{key:"getAllMoves",value:function(e){var t=e.state.checker.state,i=t.isKing,n=t.player,a=[],r=e.state.position.cell,s=r.row,o=r.column;return(1===n.state.id||i)&&(s>0&&o>0&&a.push(this.state.boxes.get("".concat(s-1).concat(o-1))),s>0&&o<this.state.columns-1&&a.push(this.state.boxes.get("".concat(s-1).concat(o+1)))),(0===n.state.id||i)&&(s<this.state.rows-1&&o>0&&a.push(this.state.boxes.get("".concat(s+1).concat(o-1))),s<this.state.rows-1&&o<this.state.columns-1&&a.push(this.state.boxes.get("".concat(s+1).concat(o+1)))),a}},{key:"getAvailableMove",value:function(e){var t=this.state.availableMoves.findIndex((function(t){return t.end.state.position.cell===e.state.position.cell}));return this.state.availableMoves[t]}},{key:"setAvailableMoves",value:function(e){var t=this.getAllMoves(e);this.state.availableMoves=this.filterMoves(e,t)}},{key:"filterMoves",value:function(e,t){var i=this,n=[],a=[],r=e.state.checker.state.player;return t.forEach((function(t){if(t.hasChecker()){if(i.checkIfOpponentChecker(t,r.state.id)&&i.checkIfJumpIsPossible(e.state.position.cell,t.state.position.cell)){var s=i.getJumpPosition(e.state.position.cell,t.state.position.cell),o=i.state.boxes.get("".concat(s.row).concat(s.column));a.push({start:e,end:o,isJump:!0,jumpedBox:t})}}else n.push({start:e,end:t,isJump:!1,jumpedBox:null})})),a.concat(n)}},{key:"checkIfOpponentChecker",value:function(e,t){return t!==e.state.checker.state.player.state.id}},{key:"checkIfJumpIsPossible",value:function(e,t){var i=this.getJumpPosition(e,t),n=i.row,a=i.column;return!(n<0||n>=8||a<0||a>=8||this.state.boxes.get("".concat(n).concat(a)).hasChecker())}},{key:"getJumpPosition",value:function(e,t){return{row:t.row-(e.row-t.row),column:t.column-(e.column-t.column)}}},{key:"checkForWin",value:function(e){return 0===e?0===this.state.playerTwoCheckersRemaining:0===this.state.playerOneCheckersRemaining}},{key:"checkIfKinged",value:function(e,t,i){(0===e&&t===this.state.rows-1||1===e&&0===t)&&i.makeKing()}},{key:"checkForAdditionalJumps",value:function(e){var t=e.end;this.setAvailableMoves(t);var i=this.state.availableMoves.filter((function(e){return e.isJump}));return i.length>0&&(this.state.availableMoves=i,this.state.availableMoves.push({start:t,end:t,isJump:!1,jumpedBox:null}),!0)}}],[{key:"boardBuilder",value:function(t){e.boxSize=e.calculateBoxSize();for(var i=e.calculateTopPadding(),n=e.calculateSidePadding(),a={rows:e.rows,columns:e.columns,boxes:new Map,topPadding:i,sidePadding:n,playerOneCheckersRemaining:12,playerTwoCheckersRemaining:12,availableMoves:[]},r=t[0],s=t[1],o=0;o<a.rows;o++)for(var c=0;c<a.columns;c++){var l=y.a.isOdd(o+c),h={row:o,column:c},u=e.calculateBoxPositions(h,a.topPadding,a.sidePadding),d=f.boxBuilder(l,{cell:h,point:u},e.boxSize);l&&(o<3?d.buildChecker(r):o>4&&d.buildChecker(s)),a.boxes.set("".concat(o).concat(c),d)}return new e(a)}},{key:"calculateBoxPositions",value:function(t,i,n){return{x:t.column*e.boxSize+n,y:t.row*e.boxSize+i}}},{key:"calculateBoxSize",value:function(){return innerWidth>innerHeight?innerHeight/(e.rows+2):innerWidth/(e.rows+2)}},{key:"calculateTopPadding",value:function(){return innerWidth>innerHeight?e.boxSize:(innerHeight-8*e.boxSize)/2}},{key:"calculateSidePadding",value:function(){return innerWidth>innerHeight?(innerWidth-8*e.boxSize)/2:e.boxSize}}]),e}()).rows=8,s.columns=8,s),g=function(){function e(t){i(this,e),this.state=t}return a(e,null,[{key:"playerBuilder",value:function(t,i){return new e({id:t-1,name:"Player "+t,color:i,numberOfPieces:16})}}]),e}(),b=r("8Y7J"),m=["checkers"],x=[{path:"",component:(c=function(){function t(){i(this,t),this.colors={playerOne:"dodgerblue",playerTwo:"goldenrod"}}return a(t,[{key:"ngOnInit",value:function(){this.setProperties(),this.setInitialState()}},{key:"ngAfterViewInit",value:function(){this.getCheckerImageData()}},{key:"setProperties",value:function(){this.ctx=this.canvas.nativeElement.getContext("2d"),this.canvasPadding=40}},{key:"setInitialState",value:function(){this.playerOne=g.playerBuilder(1,this.colors.playerOne),this.playerTwo=g.playerBuilder(2,this.colors.playerTwo),this.playerBarWidth=20,this.currentPlayer=this.playerOne,this.holdingChecker=!1,this.isPlaying=!0,this.board=p.boardBuilder([this.playerOne,this.playerTwo]),this.halfBoxSize=.5*p.boxSize}},{key:"setCanvasDimensions",value:function(){this.canvas.nativeElement.width=innerWidth,this.canvas.nativeElement.height=innerHeight-this.canvasPadding}},{key:"getCheckerImageData",value:function(){return Object(v.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,i,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.halfBoxSize,i=this.halfBoxSize,n=.46*p.boxSize,this.canvas.nativeElement.width=p.boxSize,this.canvas.nativeElement.height=p.boxSize,this.checkerImgPlayerOne=new Image,this.checkerImgPlayerOne.src=this.drawCheckerImage(t,i,n,this.colors.playerOne,!1),this.checkerImgPlayerTwo=new Image,this.checkerImgPlayerTwo.src=this.drawCheckerImage(t,i,n,this.colors.playerTwo,!1),this.checkerImgKingPlayerOne=new Image,this.checkerImgKingPlayerOne.src=this.drawCheckerImage(t,i,n,this.colors.playerOne,!0),this.checkerImgKingPlayerTwo=new Image,this.checkerImgKingPlayerTwo.src=this.drawCheckerImage(t,i,n,this.colors.playerTwo,!0),this.refreshCanvas(),e.next=14,this.loadImages([this.checkerImgPlayerOne,this.checkerImgPlayerTwo,this.checkerImgKingPlayerOne,this.checkerImgKingPlayerTwo]);case 14:this.setCanvasDimensions(),this.draw();case 16:case"end":return e.stop()}}),e,this)})))}},{key:"loadImages",value:function(t){return Object(v.a)(this,void 0,void 0,regeneratorRuntime.mark((function i(){return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",new Promise((function(i,n){var a,r=e(t);try{var s=function(){var e=a.value;e.onload=function(){return i(e)},e.onerror=n};for(r.s();!(a=r.n()).done;)s()}catch(o){r.e(o)}finally{r.f()}})));case 1:case"end":return i.stop()}}),i)})))}},{key:"getCheckerCenter",value:function(e,t){return{x:e-=this.halfBoxSize,y:t-=2*this.halfBoxSize}}},{key:"handleClick",value:function(e){if(this.isPlaying){var t=this.board.getBoxIndex(e.clientX,e.clientY),i=this.board.getBox(t);if(i){if(this.holdingChecker){var n=this.board.getAvailableMove(i);n?this.placeChecker(n):this.returnChecker()}else i.checkForValidChecker(this.currentPlayer)&&(this.board.setAvailableMoves(i),this.board.state.availableMoves.length>0&&this.pickUpChecker(i)),this.lastBoxClicked=i;this.draw()}}}},{key:"handleMouseMove",value:function(e){if(this.holdingChecker){var t=this.getCheckerCenter(e.clientX,e.clientY);this.checkerHeld.updatePosition(t),this.draw()}}},{key:"pickUpChecker",value:function(e){this.holdingChecker=!0,this.checkerHeld=e.state.checker,e.removeChecker()}},{key:"placeChecker",value:function(e){var t,i=this.currentPlayer.state.id,n=e.end.state.position.cell.row;e.end.addChecker(this.checkerHeld),e.isJump&&(this.board.removeCheckerFromBoard(e.jumpedBox),t=this.board.checkForAdditionalJumps(e)),t?this.pickUpChecker(e.end):(this.checkerHeld.state.isKing||this.board.checkIfKinged(i,n,this.checkerHeld),this.board.checkForWin(this.currentPlayer.state.id)&&(this.isPlaying=!1,console.log("Player ".concat(this.currentPlayer.state.id+1," wins!"))),this.changePlayer(),this.board.resetAvailableMoves(),this.holdingChecker=!1,this.checkerHeld=null)}},{key:"returnChecker",value:function(){var e=this.lastBoxClicked.state.absoluteCenter,t=e.x,i=e.y,n=this.getCheckerCenter(t,i);this.checkerHeld.updatePosition(n),this.lastBoxClicked.addChecker(this.checkerHeld),this.board.resetAvailableMoves(),this.holdingChecker=!1,this.checkerHeld=null}},{key:"changePlayer",value:function(){this.currentPlayer=0===this.currentPlayer.state.id?this.playerTwo:this.playerOne}},{key:"draw",value:function(){this.refreshCanvas(),this.drawPlayerBar(),this.drawBackground(),this.drawBoard(),this.board.state.availableMoves.length>0&&(this.drawHighlightedSpace(),this.drawAvailableMoves()),this.holdingChecker&&this.drawChecker(this.checkerHeld)}},{key:"refreshCanvas",value:function(){this.ctx.clearRect(0,0,innerWidth,innerHeight-2*this.canvasPadding)}},{key:"drawPlayerBar",value:function(){this.ctx.fillStyle=this.currentPlayer.state.color,this.ctx.fillRect(0,0,innerWidth,innerHeight-this.canvasPadding)}},{key:"drawBackground",value:function(){var e=this.playerBarWidth,t=e,i=e,n=this.canvas.nativeElement.width-2*e,a=this.canvas.nativeElement.height-2*e;this.ctx.fillStyle="ivory",this.ctx.fillRect(t,i,n,a)}},{key:"drawBoard",value:function(){var e=this;this.board.getBoxesArray().forEach((function(t){e.drawBox(t),t.hasChecker()&&e.drawChecker(t.state.checker)}))}},{key:"drawChecker",value:function(e){var t=e.state.position.point,i=t.x,n=t.y;this.ctx.drawImage(0===e.state.player.state.id?e.state.isKing?this.checkerImgKingPlayerOne:this.checkerImgPlayerOne:e.state.isKing?this.checkerImgKingPlayerTwo:this.checkerImgPlayerTwo,i,n)}},{key:"drawBox",value:function(e){var t=e.state,i=t.color,n=t.width,a=t.height,r=e.state.position.point,s=r.x,o=r.y;this.ctx.fillStyle=i,this.ctx.fillRect(s,o,n,a),this.ctx.lineWidth=.5,this.ctx.strokeStyle="black",this.ctx.strokeRect(s,o,n,a)}},{key:"drawCheckerImage",value:function(e,t,i,n,a){var r=n===this.colors.playerOne?"deepskyblue":"gold";this.ctx.fillStyle=n,this.ctx.beginPath(),this.ctx.arc(e,t,i,0,2*Math.PI,!0),this.ctx.fill(),this.ctx.strokeStyle=r,this.ctx.lineWidth=.05*p.boxSize;for(var s=0;s<2*Math.PI;s+=.18)this.ctx.beginPath(),this.ctx.arc(e,t,i-4,s,s+.04,!1),this.ctx.stroke();if(this.ctx.fillStyle=r,this.ctx.beginPath(),this.ctx.arc(e,t,i-10,0,2*Math.PI,!0),this.ctx.fill(),a){this.ctx.strokeStyle=n,this.ctx.lineWidth=.05*p.boxSize;var o=p.boxSize/95;this.ctx.beginPath(),this.ctx.moveTo(e+16*o,t+15*o),this.ctx.lineTo(e-15*o,t+15*o),this.ctx.lineTo(e-20*o,t-10*o),this.ctx.lineTo(e-10*o,t),this.ctx.lineTo(e,t-20*o),this.ctx.lineTo(e+10*o,t),this.ctx.lineTo(e+20*o,t-10*o),this.ctx.lineTo(e+15*o,t+15*o)}return this.ctx.stroke(),this.canvas.nativeElement.toDataURL("image/webp")}},{key:"drawHighlightedSpace",value:function(){var e=this.lastBoxClicked.state.position.point,t=e.x,i=e.y,n=this.lastBoxClicked.state,a=n.width,r=n.height;this.ctx.fillStyle="white",this.ctx.fillRect(t,i,a,r)}},{key:"drawAvailableMoves",value:function(){var e=this;this.ctx.lineWidth=6,this.board.state.availableMoves.forEach((function(t){var i=t.end.state.position.point,n=i.x,a=i.y,r=t.end.state,s=r.width,o=r.height;e.ctx.strokeStyle="yellow",e.ctx.strokeRect(n,a,s,o)}))}}]),t}(),c.\u0275fac=function(e){return new(e||c)},c.\u0275cmp=b.Fb({type:c,selectors:[["app-checkers"]],viewQuery:function(e,t){var i;1&e&&b.gc(m,!0),2&e&&b.bc(i=b.Wb())&&(t.canvas=i.first)},decls:2,vars:0,consts:[[1,"canvas",3,"click","mousemove"],["checkers",""]],template:function(e,t){1&e&&(b.Ob(0,"canvas",0,1),b.Vb("click",(function(e){return t.handleClick(e)}))("mousemove",(function(e){return t.handleMouseMove(e)})),b.Nb())},styles:[""]}),c)}],w=((h=function e(){i(this,e)}).\u0275mod=b.Jb({type:h}),h.\u0275inj=b.Ib({factory:function(e){return new(e||h)},imports:[[d.b.forChild(x)],d.b]}),h),C=((l=function e(){i(this,e)}).\u0275mod=b.Jb({type:l}),l.\u0275inj=b.Ib({factory:function(e){return new(e||l)},imports:[[u.a,w]]}),l)}}])}();
//# sourceMappingURL=checkers-checkers-module-es5.4161efbd0ff7452a3a61.js.map