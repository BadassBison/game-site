(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{qFff:function(t,s,e){"use strict";e.r(s),e.d(s,"DotsModule",(function(){return u}));var a=e("PCNd"),i=e("iInd");class n{constructor(t){this.state=t}static dotBuilder(t,s,e,a){return new n({id:`${e}${a}`,x:t,y:s,column:e,row:a,radius:8,connections:{north:null,east:null,south:null,west:null}})}addConnection(t,s){switch(t.toLocaleLowerCase()){case"north":this.state.connections.north=s;break;case"east":this.state.connections.east=s;break;case"south":this.state.connections.south=s;break;case"west":this.state.connections.west=s}}}class o{constructor(t){this.state=t}static boardBuilder(t,s,e,a,i){const h=a/t,r=e/s,c=h/2,l=r/2,d=new Map;for(let o=0;o<t;o++)for(let t=0;t<s;t++){const s=n.dotBuilder(t*r+l,o*h+c,t,o);d.set(`${t}${o}`,s)}return new o({dots:d,rows:t,columns:s,width:e,height:a,rowSpacing:h,columnSpacing:r,topPadding:c,sidePadding:l,totalSquaresLeft:(t-1)*(s-1),players:i,currentPlayer:i[0],startingDot:null,endingDot:null,currentNeighbors:null})}handleClick(t){this.state.startingDot?this.endingMove(t):this.startingMove(t)}startingMove(t){this.calculateDotClicked(t)&&this.getAvailableNeighbors()}endingMove(t){const s=this.calculateDotClicked(t),e=this.state.totalSquaresLeft;s&&(this.makeConnections(),e===this.state.totalSquaresLeft&&this.changePlayer()),this.state.startingDot=null,this.state.endingDot=null}changePlayer(){this.state.currentPlayer=this.state.players[(this.state.currentPlayer.state.id+1)%2]}calculateDotClicked({clientX:t,clientY:s}){var e,a,i,n,o,h,r,c,l;s-=40;const d=Math.floor(t/(this.state.width/this.state.columns)),u=Math.floor(s/(this.state.height/this.state.rows)),g=this.state.dots.get(`${d}${u}`);if(this.state.startingDot&&(null===(a=null===(e=this.state.currentNeighbors)||void 0===e?void 0:e.north)||void 0===a?void 0:a.state.id)!==g.state.id&&(null===(n=null===(i=this.state.currentNeighbors)||void 0===i?void 0:i.east)||void 0===n?void 0:n.state.id)!==g.state.id&&(null===(h=null===(o=this.state.currentNeighbors)||void 0===o?void 0:o.south)||void 0===h?void 0:h.state.id)!==g.state.id&&(null===(c=null===(r=this.state.currentNeighbors)||void 0===r?void 0:r.west)||void 0===c?void 0:c.state.id)!==g.state.id)return!1;const v=s-g.state.y,D=t-g.state.x;return Math.sqrt(v*v+D*D)<Math.floor(1.5*g.state.radius)?null!==this.state.startingDot&&(null===(l=this.state.startingDot)||void 0===l?void 0:l.state.id)!==g.state.id?(this.state.endingDot=g,!0):!this.state.startingDot&&(this.state.startingDot=g,!0):(this.state.startingDot=null,!1)}getAvailableNeighbors(){const{column:t,row:s}=this.state.startingDot.state,{connections:e}=this.state.startingDot.state;let a,i,n,o;!e.north&&s>0&&(a=this.state.dots.get(`${t}${s-1}`)),!e.east&&t<this.state.columns-1&&(i=this.state.dots.get(`${t+1}${s}`)),!e.south&&s<this.state.rows-1&&(n=this.state.dots.get(`${t}${s+1}`)),!e.west&&t>0&&(o=this.state.dots.get(`${t-1}${s}`)),this.state.currentNeighbors={north:a,east:i,south:n,west:o}}makeConnections(){var t,s,e,a,i,n,o,h;let r;const c=this.state.currentNeighbors;(null===(t=c.north)||void 0===t?void 0:t.state.id)===(null===(s=this.state.endingDot)||void 0===s?void 0:s.state.id)&&(r="north",this.state.startingDot.addConnection("north",this.state.endingDot),this.state.endingDot.addConnection("south",this.state.startingDot)),(null===(e=c.east)||void 0===e?void 0:e.state.id)===(null===(a=this.state.endingDot)||void 0===a?void 0:a.state.id)&&(r="east",this.state.startingDot.addConnection("east",this.state.endingDot),this.state.endingDot.addConnection("west",this.state.startingDot)),(null===(i=c.south)||void 0===i?void 0:i.state.id)===(null===(n=this.state.endingDot)||void 0===n?void 0:n.state.id)&&(r="south",this.state.startingDot.addConnection("south",this.state.endingDot),this.state.endingDot.addConnection("north",this.state.startingDot)),(null===(o=c.west)||void 0===o?void 0:o.state.id)===(null===(h=this.state.endingDot)||void 0===h?void 0:h.state.id)&&(r="west",this.state.startingDot.addConnection("west",this.state.endingDot),this.state.endingDot.addConnection("east",this.state.startingDot)),this.detectFullSquare(r)}detectFullSquare(t){"north"===t||"south"===t?(this.checkLeftSquare(t),this.checkRightSquare(t)):"west"!==t&&"east"!==t||(this.checkTopSquare(t),this.checkBottomSquare(t))}checkLeftSquare(t){var s,e;(null===(s=this.state.startingDot)||void 0===s?void 0:s.state.connections.west)&&(null===(e=this.state.endingDot)||void 0===e?void 0:e.state.connections.west)&&this.state.startingDot.state.connections.west.state.connections[t]&&("north"===t?0===this.state.currentPlayer.state.id?this.state.players[0].state.squares.push(this.state.endingDot.state.connections.west):this.state.players[1].state.squares.push(this.state.endingDot.state.connections.west):0===this.state.currentPlayer.state.id?this.state.players[0].state.squares.push(this.state.startingDot.state.connections.west):this.state.players[1].state.squares.push(this.state.startingDot.state.connections.west),this.state.totalSquaresLeft--)}checkRightSquare(t){var s,e;(null===(s=this.state.startingDot)||void 0===s?void 0:s.state.connections.east)&&(null===(e=this.state.endingDot)||void 0===e?void 0:e.state.connections.east)&&this.state.startingDot.state.connections.east.state.connections[t]&&("north"===t?0===this.state.currentPlayer.state.id?this.state.players[0].state.squares.push(this.state.endingDot):this.state.players[1].state.squares.push(this.state.endingDot):0===this.state.currentPlayer.state.id?this.state.players[0].state.squares.push(this.state.startingDot):this.state.players[1].state.squares.push(this.state.startingDot),this.state.totalSquaresLeft--)}checkTopSquare(t){var s,e;(null===(s=this.state.startingDot)||void 0===s?void 0:s.state.connections.north)&&(null===(e=this.state.endingDot)||void 0===e?void 0:e.state.connections.north)&&this.state.startingDot.state.connections.north.state.connections[t]&&("west"===t?0===this.state.currentPlayer.state.id?this.state.players[0].state.squares.push(this.state.endingDot.state.connections.north):this.state.players[1].state.squares.push(this.state.endingDot.state.connections.north):0===this.state.currentPlayer.state.id?this.state.players[0].state.squares.push(this.state.startingDot.state.connections.north):this.state.players[1].state.squares.push(this.state.startingDot.state.connections.north),this.state.totalSquaresLeft--)}checkBottomSquare(t){var s,e;(null===(s=this.state.startingDot)||void 0===s?void 0:s.state.connections.south)&&(null===(e=this.state.endingDot)||void 0===e?void 0:e.state.connections.south)&&this.state.startingDot.state.connections.south.state.connections[t]&&("west"===t?0===this.state.currentPlayer.state.id?this.state.players[0].state.squares.push(this.state.endingDot):this.state.players[1].state.squares.push(this.state.endingDot):0===this.state.currentPlayer.state.id?this.state.players[0].state.squares.push(this.state.startingDot):this.state.players[1].state.squares.push(this.state.startingDot),this.state.totalSquaresLeft--)}}class h{constructor(t){this.state=t}static playerBuilder(t,s,e){return new h({id:t-1,name:e||"Player "+t,color:s,squares:[]})}}var r=e("8Y7J");const c=["dots"],l=[{path:"",component:(()=>{class t{constructor(){this.rows=8,this.columns=8,this.highlightRadius=16}ngAfterViewInit(){this.ctx=this.canvas.nativeElement.getContext("2d"),this.setCanvasDimensions(),this.board=o.boardBuilder(this.rows,this.columns,this.canvas.nativeElement.width,this.canvas.nativeElement.height,this.buildPlayers()),this.draw()}setCanvasDimensions(){this.canvas.nativeElement.width=innerWidth,this.canvas.nativeElement.height=innerHeight-40}buildPlayers(){return[h.playerBuilder(1,"blue"),h.playerBuilder(2,"red")]}handleClick(t){this.board.handleClick(t),this.board.state.startingDot?(this.highlightClickedDot(),this.highlightNeighbors()):this.draw()}clearCanvas(){this.ctx.clearRect(0,0,this.canvas.nativeElement.width,this.canvas.nativeElement.height)}drawPlayerBorder(){this.ctx.strokeStyle=this.board.state.currentPlayer.state.color,this.ctx.lineWidth=30,this.ctx.strokeRect(0,0,this.canvas.nativeElement.width,this.canvas.nativeElement.height)}draw(){this.clearCanvas(),this.drawPlayerBorder(),this.drawDots(this.board.state.dots),this.fillSquares()}drawDots(t){t.forEach(t=>{this.drawDot(t,!1),this.drawConnections(t)})}drawDot(t,s){this.ctx.fillStyle=s?"pink":"black",this.ctx.beginPath(),this.ctx.arc(t.state.x,t.state.y,t.state.radius,0,2*Math.PI,!0),this.ctx.fill()}drawConnections(t){const{north:s,east:e,south:a,west:i}=t.state.connections;this.ctx.strokeStyle="black",this.ctx.lineWidth=6,this.ctx.beginPath(),this.ctx.moveTo(t.state.x,t.state.y),s&&(this.ctx.lineTo(s.state.x,s.state.y),this.ctx.moveTo(t.state.x,t.state.y)),e&&(this.ctx.lineTo(e.state.x,e.state.y),this.ctx.moveTo(t.state.x,t.state.y)),a&&(this.ctx.lineTo(a.state.x,a.state.y),this.ctx.moveTo(t.state.x,t.state.y)),i&&this.ctx.lineTo(i.state.x,i.state.y),this.ctx.stroke()}fillSquare(t,s){this.ctx.fillStyle=this.board.state.players[s].state.color,this.ctx.fillRect(t.state.x,t.state.y,this.board.state.columnSpacing,this.board.state.rowSpacing)}fillSquares(){this.board.state.players[0].state.squares.forEach(t=>{this.fillSquare(t,0)}),this.board.state.players[1].state.squares.forEach(t=>{this.fillSquare(t,1)})}highlightClickedDot(){this.drawDot(this.board.state.startingDot,!0)}highlightNeighbors(){const{north:t,east:s,south:e,west:a}=this.board.state.currentNeighbors;this.ctx.strokeStyle="goldenrod",this.ctx.lineWidth=4,this.ctx.beginPath(),t&&this.ctx.arc(t.state.x,t.state.y,this.highlightRadius,0,2*Math.PI,!0),s&&(this.ctx.moveTo(s.state.x+this.highlightRadius,s.state.y),this.ctx.arc(s.state.x,s.state.y,this.highlightRadius,0,2*Math.PI,!0)),e&&(this.ctx.moveTo(e.state.x+this.highlightRadius,e.state.y),this.ctx.arc(e.state.x,e.state.y,this.highlightRadius,0,2*Math.PI,!0)),a&&(this.ctx.moveTo(a.state.x+this.highlightRadius,a.state.y),this.ctx.arc(a.state.x,a.state.y,this.highlightRadius,0,2*Math.PI,!0)),this.ctx.stroke()}}return t.\u0275fac=function(s){return new(s||t)},t.\u0275cmp=r.Fb({type:t,selectors:[["app-dots"]],viewQuery:function(t,s){var e;1&t&&r.gc(c,!0),2&t&&r.bc(e=r.Wb())&&(s.canvas=e.first)},decls:2,vars:0,consts:[[1,"canvas",3,"click"],["dots",""]],template:function(t,s){1&t&&(r.Ob(0,"canvas",0,1),r.Vb("click",(function(t){return s.handleClick(t)})),r.Nb())},styles:[""]}),t})()}];let d=(()=>{class t{}return t.\u0275mod=r.Jb({type:t}),t.\u0275inj=r.Ib({factory:function(s){return new(s||t)},imports:[[i.b.forChild(l)],i.b]}),t})(),u=(()=>{class t{}return t.\u0275mod=r.Jb({type:t}),t.\u0275inj=r.Ib({factory:function(s){return new(s||t)},imports:[[a.a,d]]}),t})()}}]);
//# sourceMappingURL=games-dots-dots-module-es2015.c9b340fcaed98923c1c5.js.map