(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{"3wOr":function(e,t,s){"use strict";s.r(t),s.d(t,"CheckersModule",(function(){return m}));var i=s("PCNd"),a=s("iInd"),r=s("mrSG");let o=(()=>{class e{constructor(e){this.state=e}static checkerBuilder(t,s,i){const a={color:e.colors[t.state.id],player:t,position:s,radius:i,isKing:!1,center:e.getCenter(s,i)};return new e(a)}static getCenter(e,t){return{x:e.point.x+t,y:e.point.y+t}}updatePosition(e){this.state.position.point=e}makeKing(){this.state.isKing=!0}}return e.colors=["dodgerblue","goldenrod"],e})();var c=s("BFKe");let n=(()=>{class e{constructor(e){this.state=e}static boxBuilder(t,s,i){const a={id:`${s.cell.row}${s.cell.column}`,color:t?e.colors.playable:e.colors.unPlayable,checker:t?e.empty:e.unplayableSpace,position:s,width:i,height:i,absoluteCenter:c.a.findAbsoluteCenterPointOfRectangle(s,i,i),relativeCenter:c.a.findRelativeCenterPointOfRectangle(i,i)};return new e(a)}buildChecker(e){const{cell:t,point:s}=this.state.position;this.state.checker=o.checkerBuilder(e,{cell:t,point:s},Math.floor(.46*this.state.width))}hasChecker(){return this.state.checker!==e.empty&&this.state.checker!==e.unplayableSpace}addChecker(e){e.state.position.cell=this.state.position.cell,e.state.position.point=this.state.position.point,this.state.checker=e}removeChecker(){this.state.checker=e.empty}checkForValidChecker(e){return!!this.hasChecker()&&e.state.id===this.state.checker.state.player.state.id}}return e.colors={playable:"palegreen",unPlayable:"darkgray"},e.empty="empty",e.unplayableSpace="unplayable space",e})(),h=(()=>{class e{constructor(e){this.state=e}static boardBuilder(t){e.boxSize=e.calculateBoxSize();const s=e.calculateTopPadding(),i=e.calculateSidePadding(),a={rows:e.rows,columns:e.columns,boxes:new Map,topPadding:s,sidePadding:i,playerOneCheckersRemaining:12,playerTwoCheckersRemaining:12,availableMoves:[]},r=t[0],o=t[1];for(let h=0;h<a.rows;h++)for(let t=0;t<a.columns;t++){const s=c.a.isOdd(h+t),i={row:h,column:t},l=e.calculateBoxPositions(i,a.topPadding,a.sidePadding),d=n.boxBuilder(s,{cell:i,point:l},e.boxSize);s&&(h<3?d.buildChecker(o):h>4&&d.buildChecker(r)),a.boxes.set(`${h}${t}`,d)}return new e(a)}static calculateBoxPositions(t,s,i){return{x:t.column*e.boxSize+i,y:t.row*e.boxSize+s}}static calculateBoxSize(){return innerWidth>innerHeight?innerHeight/(e.rows+2):innerWidth/(e.rows+2)}static calculateTopPadding(){return innerWidth>innerHeight?e.boxSize-20:(innerHeight-8*e.boxSize)/2-20}static calculateSidePadding(){return innerWidth>innerHeight?(innerWidth-8*e.boxSize)/2:e.boxSize}setupBoardState(e){this.state={rows:8,columns:8,boxes:new Map,topPadding:null,sidePadding:null,playerOneCheckersRemaining:12,playerTwoCheckersRemaining:12,availableMoves:null},this.buildBoard(e),this.state.availableMoves=[]}buildBoard(t){const s=t[0],i=t[1];this.state.boxes=new Map;for(let a=0;a<this.state.rows;a++)for(let t=0;t<this.state.columns;t++){const r=c.a.isOdd(a+t),o={row:a,column:t},h=this.getBoxPosition(a,t),l=n.boxBuilder(r,{cell:o,point:h},e.boxSize);r&&(a<3?l.buildChecker(s):a>4&&l.buildChecker(i)),this.state.boxes.set(`${a}${t}`,l)}}removeCheckerFromBoard(e){this.decreasePlayersCheckers(e.state.checker),e.removeChecker()}decreasePlayersCheckers(e){0===e.state.player.state.id?this.state.playerOneCheckersRemaining--:this.state.playerTwoCheckersRemaining--}getBox(e){return this.state.boxes.get(`${e.row}${e.column}`)}getBoxPosition(t,s){return{x:s*e.boxSize+this.state.sidePadding,y:t*e.boxSize+this.state.topPadding}}getBoxIndex(t,s){return{row:Math.floor((s-this.state.topPadding-40)/e.boxSize),column:Math.floor((t-this.state.sidePadding)/e.boxSize)}}getBoxesArray(){const e=[];for(let t=0;t<this.state.rows;t++)for(let s=0;s<this.state.columns;s++)e.push(this.state.boxes.get(`${t}${s}`));return e}resetAvailableMoves(){this.state.availableMoves=[]}getAllMoves(e){const{isKing:t}=e.state.checker.state,s=[],{row:i,column:a}=e.state.position.cell;return i>0&&a>0&&s.push(this.state.boxes.get(`${i-1}${a-1}`)),i>0&&a<this.state.columns-1&&s.push(this.state.boxes.get(`${i-1}${a+1}`)),t&&(i<this.state.rows-1&&a>0&&s.push(this.state.boxes.get(`${i+1}${a-1}`)),i<this.state.rows-1&&a<this.state.columns-1&&s.push(this.state.boxes.get(`${i+1}${a+1}`))),s}getAvailableMove(e){const t=this.state.availableMoves.findIndex(t=>t.end.state.position.cell===e.state.position.cell);return this.state.availableMoves[t]}setAvailableMoves(e){const t=this.getAllMoves(e);this.state.availableMoves=this.filterMoves(e,t)}filterMoves(e,t){const s=[],i=[],{player:a}=e.state.checker.state;return t.forEach(t=>{if(t.hasChecker()){if(this.checkIfOpponentChecker(t,a.state.id)&&this.checkIfJumpIsPossible(e.state.position.cell,t.state.position.cell)){const s=this.getJumpPosition(e.state.position.cell,t.state.position.cell),a=this.state.boxes.get(`${s.row}${s.column}`);i.push({start:e,end:a,isJump:!0,jumpedBox:t})}}else s.push({start:e,end:t,isJump:!1,jumpedBox:null})}),i.concat(s)}checkIfOpponentChecker(e,t){return t!==e.state.checker.state.player.state.id}checkIfJumpIsPossible(e,t){const{row:s,column:i}=this.getJumpPosition(e,t);return!(s<0||s>=8||i<0||i>=8||this.state.boxes.get(`${s}${i}`).hasChecker())}getJumpPosition(e,t){return{row:t.row-(e.row-t.row),column:t.column-(e.column-t.column)}}checkForWin(e){return 0===e?0===this.state.playerTwoCheckersRemaining:0===this.state.playerOneCheckersRemaining}checkIfKinged(e,t){0===e&&t.makeKing()}checkForAdditionalJumps(e){const t=e.end;this.setAvailableMoves(t);const s=this.state.availableMoves.filter(e=>e.isJump);return s.length>0&&(this.state.availableMoves=s,this.state.availableMoves.push({start:t,end:t,isJump:!1,jumpedBox:null}),!0)}}return e.rows=8,e.columns=8,e})();class l{constructor(e){this.state=e}static playerBuilder(e,t){return new l({id:e-1,name:"Player "+e,color:t,numberOfPieces:16})}}var d=s("GS7A"),u=s("8Y7J");const g=["checkers"],p=[{path:"",component:(()=>{class e{constructor(){this.colors={playerOne:"dodgerblue",playerTwo:"goldenrod"}}ngOnInit(){this.setProperties(),this.setInitialState()}ngAfterViewInit(){this.getCheckerImageData()}setProperties(){this.ctx=this.canvas.nativeElement.getContext("2d"),this.canvasPadding=40}setInitialState(){this.playerOne=l.playerBuilder(1,this.colors.playerOne),this.playerTwo=l.playerBuilder(2,this.colors.playerTwo),this.playerBarWidth=20,this.currentPlayer=this.playerOne,this.holdingChecker=!1,this.isPlaying=!0,this.board=h.boardBuilder([this.playerOne,this.playerTwo]),this.halfBoxSize=.5*h.boxSize,this.canvasRotated=!1}setCanvasDimensions(){this.canvas.nativeElement.width=innerWidth,this.canvas.nativeElement.height=innerHeight-this.canvasPadding}getCheckerImageData(){return Object(r.a)(this,void 0,void 0,(function*(){const e=this.halfBoxSize,t=this.halfBoxSize,s=.46*h.boxSize;this.canvas.nativeElement.width=h.boxSize,this.canvas.nativeElement.height=h.boxSize,this.checkerImgPlayerOne=new Image,this.checkerImgPlayerOne.src=this.drawCheckerImage(e,t,s,this.colors.playerOne,!1),this.checkerImgPlayerTwo=new Image,this.checkerImgPlayerTwo.src=this.drawCheckerImage(e,t,s,this.colors.playerTwo,!1),this.checkerImgKingPlayerOne=new Image,this.checkerImgKingPlayerOne.src=this.drawCheckerImage(e,t,s,this.colors.playerOne,!0),this.checkerImgKingPlayerTwo=new Image,this.checkerImgKingPlayerTwo.src=this.drawCheckerImage(e,t,s,this.colors.playerTwo,!0),this.refreshCanvas(),yield this.loadImages([this.checkerImgPlayerOne,this.checkerImgPlayerTwo,this.checkerImgKingPlayerOne,this.checkerImgKingPlayerTwo]),this.setCanvasDimensions(),this.draw()}))}loadImages(e){return Object(r.a)(this,void 0,void 0,(function*(){return new Promise((t,s)=>{for(const i of e)i.onload=()=>t(i),i.onerror=s})}))}getCheckerCenter(e,t){return{x:e-=this.halfBoxSize,y:t-=2*this.halfBoxSize}}handleClick(e){if(this.isPlaying){const t=this.board.getBoxIndex(e.clientX,e.clientY),s=this.board.getBox(t);if(s){if(this.holdingChecker){const e=this.board.getAvailableMove(s);e?this.placeChecker(e):this.returnChecker()}else s.checkForValidChecker(this.currentPlayer)&&(this.board.setAvailableMoves(s),this.board.state.availableMoves.length>0&&this.pickUpChecker(s)),this.lastBoxClicked=s;this.draw()}}}handleMouseMove(e){if(this.holdingChecker){const t=this.getCheckerCenter(e.clientX,e.clientY);this.checkerHeld.updatePosition(t),this.draw()}}pickUpChecker(e){this.holdingChecker=!0,this.checkerHeld=e.state.checker,e.removeChecker()}placeChecker(e){const t=e.end.state.position.cell.row;let s;e.end.addChecker(this.checkerHeld),e.isJump&&(this.board.removeCheckerFromBoard(e.jumpedBox),s=this.board.checkForAdditionalJumps(e)),s?this.pickUpChecker(e.end):(this.checkerHeld.state.isKing||this.board.checkIfKinged(t,this.checkerHeld),this.board.checkForWin(this.currentPlayer.state.id)&&(this.isPlaying=!1,console.log(`Player ${this.currentPlayer.state.id+1} wins!`)),this.changePlayer(),this.board.resetAvailableMoves(),this.holdingChecker=!1,this.checkerHeld=null)}returnChecker(){const{x:e,y:t}=this.lastBoxClicked.state.absoluteCenter,s=this.getCheckerCenter(e,t);this.checkerHeld.updatePosition(s),this.lastBoxClicked.addChecker(this.checkerHeld),this.board.resetAvailableMoves(),this.holdingChecker=!1,this.checkerHeld=null}changePlayer(){this.rotateBoard(),this.currentPlayer=0===this.currentPlayer.state.id?this.playerTwo:this.playerOne}changeCheckerPositions(){const e=h.rows-1;for(let t=0;t<h.rows/2;t++)for(let s=0;s<h.columns;s++){const i=this.board.state.boxes.get(`${t}${s}`);if(i.state.checker===n.unplayableSpace)continue;let a;i.hasChecker()&&(a=i.state.checker,i.removeChecker());const r=this.board.state.boxes.get(`${e-t}${e-s}`);let o;r.hasChecker()&&(o=r.state.checker,r.removeChecker()),o&&i.addChecker(o),a&&r.addChecker(a)}}rotateBoard(){this.canvasRotated=!0,setTimeout(()=>{this.changeCheckerPositions(),this.canvasRotated=!1,this.draw()},2e3)}draw(){this.refreshCanvas(),this.drawPlayerBar(),this.drawBackground(),this.drawBoard(),this.board.state.availableMoves.length>0&&(this.drawHighlightedSpace(),this.drawAvailableMoves()),this.holdingChecker&&this.drawChecker(this.checkerHeld)}refreshCanvas(){this.ctx.clearRect(0,0,innerWidth,innerHeight-2*this.canvasPadding)}drawPlayerBar(){this.ctx.fillStyle=this.currentPlayer.state.color,this.ctx.fillRect(0,0,innerWidth,innerHeight-this.canvasPadding)}drawBackground(){const e=this.playerBarWidth,t=e,s=e,i=this.canvas.nativeElement.width-2*e,a=this.canvas.nativeElement.height-2*e;this.ctx.fillStyle="ivory",this.ctx.fillRect(t,s,i,a)}drawBoard(){this.board.getBoxesArray().forEach(e=>{this.drawBox(e),e.hasChecker()&&this.drawChecker(e.state.checker)})}drawChecker(e){const{x:t,y:s}=e.state.position.point;this.ctx.drawImage(0===e.state.player.state.id?e.state.isKing?this.checkerImgKingPlayerOne:this.checkerImgPlayerOne:e.state.isKing?this.checkerImgKingPlayerTwo:this.checkerImgPlayerTwo,t,s)}drawBox(e){const{color:t,width:s,height:i}=e.state,{x:a,y:r}=e.state.position.point;this.ctx.fillStyle=t,this.ctx.fillRect(a,r,s,i),this.ctx.lineWidth=.5,this.ctx.strokeStyle="black",this.ctx.strokeRect(a,r,s,i)}drawCheckerImage(e,t,s,i,a){const r=i===this.colors.playerOne?"deepskyblue":"gold";this.ctx.fillStyle=i,this.ctx.beginPath(),this.ctx.arc(e,t,s,0,2*Math.PI,!0),this.ctx.fill(),this.ctx.strokeStyle=r,this.ctx.lineWidth=.05*h.boxSize;for(let o=0;o<2*Math.PI;o+=.18)this.ctx.beginPath(),this.ctx.arc(e,t,s-4,o,o+.04,!1),this.ctx.stroke();if(this.ctx.fillStyle=r,this.ctx.beginPath(),this.ctx.arc(e,t,s-10,0,2*Math.PI,!0),this.ctx.fill(),a){this.ctx.strokeStyle=i,this.ctx.lineWidth=.05*h.boxSize;const s=h.boxSize/95;this.ctx.beginPath(),this.ctx.moveTo(e+16*s,t+15*s),this.ctx.lineTo(e-15*s,t+15*s),this.ctx.lineTo(e-20*s,t-10*s),this.ctx.lineTo(e-10*s,t),this.ctx.lineTo(e,t-20*s),this.ctx.lineTo(e+10*s,t),this.ctx.lineTo(e+20*s,t-10*s),this.ctx.lineTo(e+15*s,t+15*s)}return this.ctx.stroke(),this.canvas.nativeElement.toDataURL("image/webp")}drawHighlightedSpace(){const{x:e,y:t}=this.lastBoxClicked.state.position.point,{width:s,height:i}=this.lastBoxClicked.state;this.ctx.fillStyle="white",this.ctx.fillRect(e,t,s,i)}drawAvailableMoves(){this.ctx.lineWidth=6,this.board.state.availableMoves.forEach(e=>{const{x:t,y:s}=e.end.state.position.point,{width:i,height:a}=e.end.state;this.ctx.strokeStyle="yellow",this.ctx.strokeRect(t,s,i,a)})}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=u.Fb({type:e,selectors:[["app-checkers"]],viewQuery:function(e,t){var s;1&e&&u.gc(g,!0),2&e&&u.bc(s=u.Wb())&&(t.canvas=s.first)},decls:2,vars:1,consts:[[1,"canvas",3,"click","mousemove"],["checkers",""]],template:function(e,t){1&e&&(u.Ob(0,"canvas",0,1),u.Vb("click",(function(e){return t.handleClick(e)}))("mousemove",(function(e){return t.handleMouseMove(e)})),u.Nb()),2&e&&u.ac("@rotationTrigger",t.canvasRotated?"rotated":"notRotated")},styles:[""],data:{animation:[Object(d.l)("rotationTrigger",[Object(d.i)("rotated",Object(d.j)({transform:"rotate(180deg)"})),Object(d.i)("notRotated",Object(d.j)({transform:"rotate(0deg)"})),Object(d.k)("notRotated => rotated",[Object(d.e)("2s 50ms ease-in-out")])])]}}),e})()}];let k=(()=>{class e{}return e.\u0275mod=u.Jb({type:e}),e.\u0275inj=u.Ib({factory:function(t){return new(t||e)},imports:[[a.b.forChild(p)],a.b]}),e})();var b=s("Dxy4");let m=(()=>{class e{}return e.\u0275mod=u.Jb({type:e}),e.\u0275inj=u.Ib({factory:function(t){return new(t||e)},imports:[[i.a,k,b.c]]}),e})()}}]);
//# sourceMappingURL=checkers-checkers-module-es2015.ad0f170c275fede2d2a6.js.map