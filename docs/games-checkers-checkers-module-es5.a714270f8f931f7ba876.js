!function(){function e(e,i){var a;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(a=function(e,i){if(!e)return;if("string"==typeof e)return t(e,i);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return t(e,i)}(e))||i&&e&&"number"==typeof e.length){a&&(e=a);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,c=!1;return{s:function(){a=e[Symbol.iterator]()},n:function(){var e=a.next();return o=e.done,e},e:function(e){c=!0,s=e},f:function(){try{o||null==a.return||a.return()}finally{if(c)throw s}}}}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,a=new Array(t);i<t;i++)a[i]=e[i];return a}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function n(e,t,i){return t&&a(e.prototype,t),i&&a(e,i),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{MaId:function(t,a,r){"use strict";r.r(a),r.d(a,"CheckersModule",(function(){return S}));var s,o,c,l,h,u=r("PCNd"),d=r("iInd"),v=r("mrSG"),k=function(){var e=function(){function e(t){i(this,e),this.state=t}return n(e,[{key:"updatePosition",value:function(e){this.state.position.point=e}},{key:"makeKing",value:function(){this.state.isKing=!0}}],[{key:"checkerBuilder",value:function(t,i,a){var n={color:e.colors[t.state.id],player:t,position:i,radius:a,isKing:!1,center:e.getCenter(i,a)};return new e(n)}},{key:"getCenter",value:function(e,t){return{x:e.point.x+t,y:e.point.y+t}}}]),e}();return e.colors=["dodgerblue","goldenrod"],e}(),f=r("BFKe"),y=((o=function(){function e(t){i(this,e),this.state=t}return n(e,[{key:"buildChecker",value:function(e){var t=this.state.position,i=t.cell,a=t.point;this.state.checker=k.checkerBuilder(e,{cell:i,point:a},Math.floor(.46*this.state.width))}},{key:"hasChecker",value:function(){return this.state.checker!==e.empty&&this.state.checker!==e.unplayableSpace}},{key:"addChecker",value:function(e){e.state.position.cell=this.state.position.cell,e.state.position.point=this.state.position.point,this.state.checker=e}},{key:"removeChecker",value:function(){this.state.checker=e.empty}},{key:"checkForValidChecker",value:function(e){return!!this.hasChecker()&&e.state.id===this.state.checker.state.player.state.id}}],[{key:"boxBuilder",value:function(t,i,a){return new e({id:"".concat(i.cell.row).concat(i.cell.column),color:t?e.colors.playable:e.colors.unPlayable,checker:t?e.empty:e.unplayableSpace,position:i,width:a,height:a,absoluteCenter:f.a.findAbsoluteCenterPointOfRectangle(i,a,a),relativeCenter:f.a.findRelativeCenterPointOfRectangle(a,a)})}}]),e}()).colors={playable:"palegreen",unPlayable:"darkgray"},o.empty="empty",o.unplayableSpace="unplayable space",o),g=((s=function(){function e(t){i(this,e),this.state=t}return n(e,[{key:"setupBoardState",value:function(e){this.state={rows:8,columns:8,boxes:new Map,topPadding:null,sidePadding:null,playerOneCheckersRemaining:12,playerTwoCheckersRemaining:12,availableMoves:null},this.buildBoard(e),this.state.availableMoves=[]}},{key:"buildBoard",value:function(t){var i=t[0],a=t[1];this.state.boxes=new Map;for(var n=0;n<this.state.rows;n++)for(var r=0;r<this.state.columns;r++){var s=f.a.isOdd(n+r),o={row:n,column:r},c=this.getBoxPosition(n,r),l=y.boxBuilder(s,{cell:o,point:c},e.boxSize);s&&(n<3?l.buildChecker(i):n>4&&l.buildChecker(a)),this.state.boxes.set("".concat(n).concat(r),l)}}},{key:"removeCheckerFromBoard",value:function(e){this.decreasePlayersCheckers(e.state.checker),e.removeChecker()}},{key:"decreasePlayersCheckers",value:function(e){0===e.state.player.state.id?this.state.playerOneCheckersRemaining--:this.state.playerTwoCheckersRemaining--}},{key:"getBox",value:function(e){return this.state.boxes.get("".concat(e.row).concat(e.column))}},{key:"getBoxPosition",value:function(t,i){return{x:i*e.boxSize+this.state.sidePadding,y:t*e.boxSize+this.state.topPadding}}},{key:"getBoxIndex",value:function(t,i){return{row:Math.floor((i-this.state.topPadding-40)/e.boxSize),column:Math.floor((t-this.state.sidePadding)/e.boxSize)}}},{key:"getBoxesArray",value:function(){for(var e=[],t=0;t<this.state.rows;t++)for(var i=0;i<this.state.columns;i++)e.push(this.state.boxes.get("".concat(t).concat(i)));return e}},{key:"resetAvailableMoves",value:function(){this.state.availableMoves=[]}},{key:"getAllMoves",value:function(e){var t=e.state.checker.state.isKing,i=[],a=e.state.position.cell,n=a.row,r=a.column;return n>0&&r>0&&i.push(this.state.boxes.get("".concat(n-1).concat(r-1))),n>0&&r<this.state.columns-1&&i.push(this.state.boxes.get("".concat(n-1).concat(r+1))),t&&(n<this.state.rows-1&&r>0&&i.push(this.state.boxes.get("".concat(n+1).concat(r-1))),n<this.state.rows-1&&r<this.state.columns-1&&i.push(this.state.boxes.get("".concat(n+1).concat(r+1)))),i}},{key:"getAvailableMove",value:function(e){var t=this.state.availableMoves.findIndex((function(t){return t.end.state.position.cell===e.state.position.cell}));return this.state.availableMoves[t]}},{key:"setAvailableMoves",value:function(e){var t=this.getAllMoves(e);this.state.availableMoves=this.filterMoves(e,t)}},{key:"filterMoves",value:function(e,t){var i=this,a=[],n=[],r=e.state.checker.state.player;return t.forEach((function(t){if(t.hasChecker()){if(i.checkIfOpponentChecker(t,r.state.id)&&i.checkIfJumpIsPossible(e.state.position.cell,t.state.position.cell)){var s=i.getJumpPosition(e.state.position.cell,t.state.position.cell),o=i.state.boxes.get("".concat(s.row).concat(s.column));n.push({start:e,end:o,isJump:!0,jumpedBox:t})}}else a.push({start:e,end:t,isJump:!1,jumpedBox:null})})),n.concat(a)}},{key:"checkIfOpponentChecker",value:function(e,t){return t!==e.state.checker.state.player.state.id}},{key:"checkIfJumpIsPossible",value:function(e,t){var i=this.getJumpPosition(e,t),a=i.row,n=i.column;return!(a<0||a>=8||n<0||n>=8||this.state.boxes.get("".concat(a).concat(n)).hasChecker())}},{key:"getJumpPosition",value:function(e,t){return{row:t.row-(e.row-t.row),column:t.column-(e.column-t.column)}}},{key:"checkForWin",value:function(e){return 0===e?0===this.state.playerTwoCheckersRemaining:0===this.state.playerOneCheckersRemaining}},{key:"checkIfKinged",value:function(e,t){0===e&&t.makeKing()}},{key:"checkForAdditionalJumps",value:function(e){var t=e.end;this.setAvailableMoves(t);var i=this.state.availableMoves.filter((function(e){return e.isJump}));return i.length>0&&(this.state.availableMoves=i,this.state.availableMoves.push({start:t,end:t,isJump:!1,jumpedBox:null}),!0)}}],[{key:"boardBuilder",value:function(t){e.boxSize=e.calculateBoxSize();for(var i=e.calculateTopPadding(),a=e.calculateSidePadding(),n={rows:e.rows,columns:e.columns,boxes:new Map,topPadding:i,sidePadding:a,playerOneCheckersRemaining:12,playerTwoCheckersRemaining:12,availableMoves:[]},r=t[0],s=t[1],o=0;o<n.rows;o++)for(var c=0;c<n.columns;c++){var l=f.a.isOdd(o+c),h={row:o,column:c},u=e.calculateBoxPositions(h,n.topPadding,n.sidePadding),d=y.boxBuilder(l,{cell:h,point:u},e.boxSize);l&&(o<3?d.buildChecker(s):o>4&&d.buildChecker(r)),n.boxes.set("".concat(o).concat(c),d)}return new e(n)}},{key:"calculateBoxPositions",value:function(t,i,a){return{x:t.column*e.boxSize+a,y:t.row*e.boxSize+i}}},{key:"calculateBoxSize",value:function(){return innerWidth>innerHeight?innerHeight/(e.rows+2):innerWidth/(e.rows+2)}},{key:"calculateTopPadding",value:function(){return innerWidth>innerHeight?e.boxSize-20:(innerHeight-8*e.boxSize)/2-20}},{key:"calculateSidePadding",value:function(){return innerWidth>innerHeight?(innerWidth-8*e.boxSize)/2:e.boxSize}}]),e}()).rows=8,s.columns=8,s),p=function(){function e(t){i(this,e),this.state=t}return n(e,null,[{key:"playerBuilder",value:function(t,i,a){return new e({id:t-1,name:a||"Player "+t,color:i,numberOfPieces:16})}}]),e}(),b=r("GS7A"),m=r("8Y7J"),x=["checkers"],w=[{path:"",component:(c=function(){function t(){i(this,t),this.colors={playerOne:"dodgerblue",playerTwo:"goldenrod"}}return n(t,[{key:"ngOnInit",value:function(){this.setProperties(),this.setInitialState()}},{key:"ngAfterViewInit",value:function(){this.getCheckerImageData()}},{key:"setProperties",value:function(){this.ctx=this.canvas.nativeElement.getContext("2d"),this.canvasPadding=40}},{key:"setInitialState",value:function(){this.playerOne=p.playerBuilder(1,this.colors.playerOne),this.playerTwo=p.playerBuilder(2,this.colors.playerTwo),this.playerBarWidth=20,this.currentPlayer=this.playerOne,this.holdingChecker=!1,this.isPlaying=!0,this.board=g.boardBuilder([this.playerOne,this.playerTwo]),this.halfBoxSize=.5*g.boxSize,this.canvasRotated=!1}},{key:"setCanvasDimensions",value:function(){this.canvas.nativeElement.width=innerWidth,this.canvas.nativeElement.height=innerHeight-this.canvasPadding}},{key:"getCheckerImageData",value:function(){return Object(v.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.halfBoxSize,i=this.halfBoxSize,a=.46*g.boxSize,this.canvas.nativeElement.width=g.boxSize,this.canvas.nativeElement.height=g.boxSize,this.checkerImgPlayerOne=new Image,this.checkerImgPlayerOne.src=this.drawCheckerImage(t,i,a,this.colors.playerOne,!1),this.checkerImgPlayerTwo=new Image,this.checkerImgPlayerTwo.src=this.drawCheckerImage(t,i,a,this.colors.playerTwo,!1),this.checkerImgKingPlayerOne=new Image,this.checkerImgKingPlayerOne.src=this.drawCheckerImage(t,i,a,this.colors.playerOne,!0),this.checkerImgKingPlayerTwo=new Image,this.checkerImgKingPlayerTwo.src=this.drawCheckerImage(t,i,a,this.colors.playerTwo,!0),this.refreshCanvas(),e.next=14,this.loadImages([this.checkerImgPlayerOne,this.checkerImgPlayerTwo,this.checkerImgKingPlayerOne,this.checkerImgKingPlayerTwo]);case 14:this.setCanvasDimensions(),this.draw();case 16:case"end":return e.stop()}}),e,this)})))}},{key:"loadImages",value:function(t){return Object(v.a)(this,void 0,void 0,regeneratorRuntime.mark((function i(){return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",new Promise((function(i,a){var n,r=e(t);try{var s=function(){var e=n.value;e.onload=function(){return i(e)},e.onerror=a};for(r.s();!(n=r.n()).done;)s()}catch(o){r.e(o)}finally{r.f()}})));case 1:case"end":return i.stop()}}),i)})))}},{key:"getCheckerCenter",value:function(e,t){return{x:e-=this.halfBoxSize,y:t-=2*this.halfBoxSize}}},{key:"handleClick",value:function(e){if(this.isPlaying){var t=this.board.getBoxIndex(e.clientX,e.clientY),i=this.board.getBox(t);if(i){if(this.holdingChecker){var a=this.board.getAvailableMove(i);a?this.placeChecker(a):this.returnChecker()}else i.checkForValidChecker(this.currentPlayer)&&(this.board.setAvailableMoves(i),this.board.state.availableMoves.length>0&&this.pickUpChecker(i)),this.lastBoxClicked=i;this.draw()}}}},{key:"handleMouseMove",value:function(e){if(this.holdingChecker){var t=this.getCheckerCenter(e.clientX,e.clientY);this.checkerHeld.updatePosition(t),this.draw()}}},{key:"pickUpChecker",value:function(e){this.holdingChecker=!0,this.checkerHeld=e.state.checker,e.removeChecker()}},{key:"placeChecker",value:function(e){var t,i=e.end.state.position.cell.row;e.end.addChecker(this.checkerHeld),e.isJump&&(this.board.removeCheckerFromBoard(e.jumpedBox),t=this.board.checkForAdditionalJumps(e)),t?this.pickUpChecker(e.end):(this.checkerHeld.state.isKing||this.board.checkIfKinged(i,this.checkerHeld),this.board.checkForWin(this.currentPlayer.state.id)&&(this.isPlaying=!1,console.log("Player ".concat(this.currentPlayer.state.id+1," wins!"))),this.changePlayer(),this.board.resetAvailableMoves(),this.holdingChecker=!1,this.checkerHeld=null)}},{key:"returnChecker",value:function(){var e=this.lastBoxClicked.state.absoluteCenter,t=e.x,i=e.y,a=this.getCheckerCenter(t,i);this.checkerHeld.updatePosition(a),this.lastBoxClicked.addChecker(this.checkerHeld),this.board.resetAvailableMoves(),this.holdingChecker=!1,this.checkerHeld=null}},{key:"changePlayer",value:function(){this.rotateBoard(),this.currentPlayer=0===this.currentPlayer.state.id?this.playerTwo:this.playerOne}},{key:"changeCheckerPositions",value:function(){for(var e=g.rows-1,t=0;t<g.rows/2;t++)for(var i=0;i<g.columns;i++){var a=this.board.state.boxes.get("".concat(t).concat(i));if(a.state.checker!==y.unplayableSpace){var n=void 0;a.hasChecker()&&(n=a.state.checker,a.removeChecker());var r=this.board.state.boxes.get("".concat(e-t).concat(e-i)),s=void 0;r.hasChecker()&&(s=r.state.checker,r.removeChecker()),s&&a.addChecker(s),n&&r.addChecker(n)}}}},{key:"rotateBoard",value:function(){var e=this;this.canvasRotated=!0,setTimeout((function(){e.changeCheckerPositions(),e.canvasRotated=!1,e.draw()}),2e3)}},{key:"draw",value:function(){this.refreshCanvas(),this.drawPlayerBar(),this.drawBackground(),this.drawBoard(),this.board.state.availableMoves.length>0&&(this.drawHighlightedSpace(),this.drawAvailableMoves()),this.holdingChecker&&this.drawChecker(this.checkerHeld)}},{key:"refreshCanvas",value:function(){this.ctx.clearRect(0,0,innerWidth,innerHeight-2*this.canvasPadding)}},{key:"drawPlayerBar",value:function(){this.ctx.fillStyle=this.currentPlayer.state.color,this.ctx.fillRect(0,0,innerWidth,innerHeight-this.canvasPadding)}},{key:"drawBackground",value:function(){var e=this.playerBarWidth,t=e,i=e,a=this.canvas.nativeElement.width-2*e,n=this.canvas.nativeElement.height-2*e;this.ctx.fillStyle="ivory",this.ctx.fillRect(t,i,a,n)}},{key:"drawBoard",value:function(){var e=this;this.board.getBoxesArray().forEach((function(t){e.drawBox(t),t.hasChecker()&&e.drawChecker(t.state.checker)}))}},{key:"drawChecker",value:function(e){var t=e.state.position.point,i=t.x,a=t.y;this.ctx.drawImage(0===e.state.player.state.id?e.state.isKing?this.checkerImgKingPlayerOne:this.checkerImgPlayerOne:e.state.isKing?this.checkerImgKingPlayerTwo:this.checkerImgPlayerTwo,i,a)}},{key:"drawBox",value:function(e){var t=e.state,i=t.color,a=t.width,n=t.height,r=e.state.position.point,s=r.x,o=r.y;this.ctx.fillStyle=i,this.ctx.fillRect(s,o,a,n),this.ctx.lineWidth=.5,this.ctx.strokeStyle="black",this.ctx.strokeRect(s,o,a,n)}},{key:"drawCheckerImage",value:function(e,t,i,a,n){var r=a===this.colors.playerOne?"deepskyblue":"gold";this.ctx.fillStyle=a,this.ctx.beginPath(),this.ctx.arc(e,t,i,0,2*Math.PI,!0),this.ctx.fill(),this.ctx.strokeStyle=r,this.ctx.lineWidth=.05*g.boxSize;for(var s=0;s<2*Math.PI;s+=.18)this.ctx.beginPath(),this.ctx.arc(e,t,i-4,s,s+.04,!1),this.ctx.stroke();if(this.ctx.fillStyle=r,this.ctx.beginPath(),this.ctx.arc(e,t,i-10,0,2*Math.PI,!0),this.ctx.fill(),n){this.ctx.strokeStyle=a,this.ctx.lineWidth=.05*g.boxSize;var o=g.boxSize/95;this.ctx.beginPath(),this.ctx.moveTo(e+16*o,t+15*o),this.ctx.lineTo(e-15*o,t+15*o),this.ctx.lineTo(e-20*o,t-10*o),this.ctx.lineTo(e-10*o,t),this.ctx.lineTo(e,t-20*o),this.ctx.lineTo(e+10*o,t),this.ctx.lineTo(e+20*o,t-10*o),this.ctx.lineTo(e+15*o,t+15*o)}return this.ctx.stroke(),this.canvas.nativeElement.toDataURL("image/webp")}},{key:"drawHighlightedSpace",value:function(){var e=this.lastBoxClicked.state.position.point,t=e.x,i=e.y,a=this.lastBoxClicked.state,n=a.width,r=a.height;this.ctx.fillStyle="white",this.ctx.fillRect(t,i,n,r)}},{key:"drawAvailableMoves",value:function(){var e=this;this.ctx.lineWidth=6,this.board.state.availableMoves.forEach((function(t){var i=t.end.state.position.point,a=i.x,n=i.y,r=t.end.state,s=r.width,o=r.height;e.ctx.strokeStyle="yellow",e.ctx.strokeRect(a,n,s,o)}))}}]),t}(),c.\u0275fac=function(e){return new(e||c)},c.\u0275cmp=m.Gb({type:c,selectors:[["app-checkers"]],viewQuery:function(e,t){var i;1&e&&m.lc(x,!0),2&e&&m.ec(i=m.Zb())&&(t.canvas=i.first)},decls:2,vars:1,consts:[[1,"canvas",3,"click","mousemove"],["checkers",""]],template:function(e,t){1&e&&(m.Rb(0,"canvas",0,1),m.Yb("click",(function(e){return t.handleClick(e)}))("mousemove",(function(e){return t.handleMouseMove(e)})),m.Qb()),2&e&&m.dc("@rotationTrigger",t.canvasRotated?"rotated":"notRotated")},styles:[""],data:{animation:[Object(b.m)("rotationTrigger",[Object(b.j)("rotated",Object(b.k)({transform:"rotate(180deg)"})),Object(b.j)("notRotated",Object(b.k)({transform:"rotate(0deg)"})),Object(b.l)("notRotated => rotated",[Object(b.e)("2s 50ms ease-in-out")])])]}}),c)}],C=((l=function e(){i(this,e)}).\u0275mod=m.Kb({type:l}),l.\u0275inj=m.Jb({factory:function(e){return new(e||l)},imports:[[d.b.forChild(w)],d.b]}),l),P=r("Dxy4"),S=((h=function e(){i(this,e)}).\u0275mod=m.Kb({type:h}),h.\u0275inj=m.Jb({factory:function(e){return new(e||h)},imports:[[u.a,C,P.c]]}),h)}}])}();
//# sourceMappingURL=games-checkers-checkers-module-es5.a714270f8f931f7ba876.js.map